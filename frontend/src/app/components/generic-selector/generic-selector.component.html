<ion-input
  [label]="label"
  label-placement="floating"
  fill="outline"
  [value]="getLabelValue()"
  readonly
  placeholder="Tocca per cercare..."
  (click)="setOpen(true)"
>
  <ion-icon slot="end" name="chevron-down-outline" style="margin-right: 10px; opacity: 0.5;"></ion-icon>
</ion-input>

<ion-modal [isOpen]="isModalOpen" (didDismiss)="setOpen(false)" [initialBreakpoint]="0.75" [breakpoints]="[0, 0.5, 0.75, 1]">
  <ng-template>
    <ion-header>
      <ion-toolbar color="light">
        <ion-searchbar 
          placeholder="Cerca..." 
          (ionInput)="filterItems($event)"
          [debounce]="250"
          animated="true">
        </ion-searchbar>
        <ion-buttons slot="end">
          <ion-button (click)="setOpen(false)">Chiudi</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    
    <ion-content>
      <ion-list lines="full">
        
        <ion-item button *ngFor="let item of filteredItems" (click)="selectItem(item)">
          
          <ion-label *ngIf="type === 'cliente'">
            <h2>{{ item.nome }}</h2>
            <p>{{ item.email || 'Nessuna email' }}</p>
          </ion-label>

          <ion-label *ngIf="type === 'cantiere'">
            <h2>{{ item.citta }} - {{ item.via }}</h2>
            <p style="font-size: 0.85em; color: var(--ion-color-primary);">
              <ion-icon name="person-outline" style="vertical-align: middle;"></ion-icon> 
              {{ item.cliente?.nome || 'Proprietario N.D.' }}
            </p>
          </ion-label>

          <ion-label *ngIf="type === 'commessa'">
            <h2>{{ item.seriale }}</h2>
            <p>{{ item.descrizione }}</p>
            <p style="font-size: 0.85em; color: var(--ion-color-tertiary);">
              <ion-icon name="business-outline" style="vertical-align: middle;"></ion-icon> 
              {{ item.indirizzo?.cliente?.nome }} - {{ item.indirizzo?.citta }}
            </p>
          </ion-label>

          <ion-icon name="checkmark-circle" slot="end" color="success" *ngIf="item.id === selectedId"></ion-icon>
        
        </ion-item>
        
        <div class="ion-padding ion-text-center" *ngIf="filteredItems.length === 0">
          <small>Nessun risultato trovato.</small>
        </div>

      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>